---
title: "DS Assignment 4"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

install.packages("tidyverse")
library(tidyverse)
read.table(file="Saanich.metadata.txt")
read.table(file="Saanich.metadata.txt", header=TRUE, row.names=1, sep="\t", na.strings="NAN")
metadata <- read.table(file="Saanich.metadata.txt", header=TRUE, row.names=1, sep="\t", na.strings="NAN")
otu= read.table(file="saanich.otu.txt", header=TRUE, row.names=1, sep="\t", na.strings="NAN")
source("https://bioconductor.org/biocLite.R")
biocLite("phyloseq")
library(phyloseq)
load("phyloseq_object.RData")


ggplot(metadata, aes(x=NO3_uM, y=Depth_m)) + 
  geom_point(shape=17, color="purple")


metadata %>% 
  mutate(Temperature_F = Temperature_C*1.8 +32) %>% 
  ggplot() + geom_point(aes(x=Temperature_F, y=Depth_m))


physeq_percent = transform_sample_counts(physeq, function(x) 100 * x/sum(x)) 
  plot_bar(physeq_percent, fill="Class") + 
  geom_bar(aes(fill=Class), stat="identity") + labs(x="Sample depth", y="Percent relative abundance")
 
   
metadata %>% 
  Select (Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM) %>%
  gather("Nutrients","uM", O2_uM:NO2_uM)%>%
  ggplot() + geom_point(aes(x=Depth_m, y=uM)) +
  facet_wrap(~Nutrients, scales="free_y") +
  theme(legend.position="none")
